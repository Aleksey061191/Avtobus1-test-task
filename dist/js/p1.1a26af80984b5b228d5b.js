(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&(t=n.currentScript.src),!t)){var a=n.getElementsByTagName("script");if(a.length)for(var c=a.length-1;c>-1&&(!t||!/^http(s?):/.test(t));)t=a[c--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t+"../"})();const t=e.p+"images/delete-forever.svg",n=e=>{localStorage.setItem("groupList",JSON.stringify(e))},a=()=>JSON.parse(localStorage.getItem("groupList"))||[];let c;function s(e){e.keyCode&&(c=e.keyCode),this.selectionStart<3&&e.preventDefault();let t="+7 (___)-___-__-__",n=0,a=t.replace(/\D/g,""),s=this.value.replace(/\D/g,""),o=t.replace(/[_\d]/g,(function(e){return n<s.length?s.charAt(n++)||a.charAt(n):e}));n=o.indexOf("_"),-1!=n&&(n<5&&(n=3),o=o.slice(0,n));let r=t.substr(0,this.value.length).replace(/_+/g,(function(e){return"\\d{1,"+e.length+"}"})).replace(/[+()]/g,"\\$&");r=new RegExp("^"+r+"$"),(!r.test(this.value)||this.value.length<5||c>47&&c<58)&&(this.value=o),"blur"==e.type&&this.value.length<5&&(this.value="")}const o=(e,t,n="")=>{const a=document.createElement("input");return a.classList.add("groupTitle","inputTitle"),a.placeholder=e,a.value=n,a.id=t,"phone"===t&&(a.addEventListener("input",s),a.addEventListener("focus",s),a.addEventListener("blur",s),a.addEventListener("keydown",s)),a},r=(e="",t="")=>{const n=document.createElement("select");n.id=t,n.required=!0;const c=document.createElement("option");return c.value="",c.innerHTML="Выберите группу",n.append(c),a().map((e=>{const t=document.createElement("option");t.value=e.group,t.innerHTML=e.group,n.append(t)})),n.value=e,n.classList.add("groupTitle","inputTitle","select"),n},l=e.p+"images/arrow.svg",d=e.p+"images/edit.svg",i=(e,t,n)=>{e.preventDefault();const c=a(),s=document.querySelector(".offcanvas-body"),l=document.querySelector(".offcanvas-title"),d=document.querySelector(".addGroup");s.innerHTML="","groups"===e.target.id?(l.innerHTML="Группы контактов",d.classList.add("visible"),c.length>0&&c.map(((e,t)=>{s.append(m(e.group,t))}))):(l.innerHTML="Добавление контакта",d.classList.remove("visible"),s.append(((e,t)=>{const n=document.createElement("div");let c,s,l;if(n.classList.add("form"),e>=0&&t>=0){const n=a(),d=n[e].group,i=n[e].contacts[t].phone,p=n[e].contacts[t].name;c=o("Введите ФИО","fio",p),s=o("Введите номер","phone",i),l=r(d,`${e}-${t}`)}else c=o("Введите ФИО","fio"),s=o("Введите номер","phone"),l=r();return n.append(c,s,l),n})(t,n)))},p=(e,t)=>{const c=a(),s=c[e];s.contacts.splice(t,1),c.splice(e,1,s),n(c)},u=()=>{const e=a(),n=document.querySelector(".mainWrapper");if(n.innerHTML="",0===e?.length){const e=document.createElement("div");e.classList.add("text");const t=document.createElement("h2");t.classList.add("content"),t.innerHTML="Список контактов пуст",e.append(t),n.append(e)}else e?.map(((e,a)=>{n.append(((e,n)=>{const a=document.createElement("div");a.classList.add("card");const c=document.createElement("div");c.classList.add("headerCollapse"),c.dataset.bsToggle="collapse",c.dataset.bsTarget=`#collapse${n}`,c.ariaExpanded="true",c.ariaControls=`collapse${n}`;const s=document.createElement("h2");s.classList.add("titleCollapse"),s.innerHTML=e.group;const o=document.createElement("img");o.src=l,o.classList.add("arrow");const r=document.createElement("div");return r.classList.add("collapse","show"),r.id=`collapse${n}`,e.contacts.map(((e,a)=>{r.append(((e,n,a)=>{const c=document.createElement("div");c.classList.add("collapseItem");const s=document.createElement("span");s.classList.add("fio"),s.innerHTML=e.name;const o=document.createElement("div");o.classList.add("controlItems");const r=document.createElement("span");r.classList.add("phone"),r.innerHTML=e.phone;const l=document.createElement("div");l.classList.add("controlBtns");const m=document.createElement("button"),g=document.createElement("img");g.src=t,g.classList.add("icon"),m.classList.add("controlBtn","delete"),m.append(g),m.onclick=()=>{p(n,a),u()};const v=document.createElement("button"),h=document.createElement("img");return h.src=d,h.classList.add("icon"),v.id="add",v.classList.add("controlBtn","edit"),v.dataset.bsToggle="offcanvas",v.dataset.bsTarget="#offcanvasWithBothOptions",v.ariaControls="offcanvasWithBothOptions",v.append(h),v.onclick=e=>{i(e,n,a)},l.append(v,m),o.append(r,l),c.append(s,o),c})(e,n,a))})),c.append(s,o),a.append(c,r),a})(e,a))}))},m=(e,c,s=!1)=>{const r=document.createElement("div");let l;r.classList.add("group"),s?l=o("Введите название","groupName"):(l=document.createElement("div"),l.classList.add("groupTitle"),l.innerHTML=e);const d=document.createElement("button"),i=document.createElement("img");return i.src=t,i.classList.add("icon"),d.classList.add("controlBtn","delete"),d.append(i),d.onclick=()=>{const e=a();r.parentElement.removeChild(r),e.splice(c,1),n(e),u()},r.append(l,d),r};u(),document.querySelector(".btns").addEventListener("click",(e=>i(e))),document.querySelector(".modalBtn").addEventListener("click",(e=>(e=>{e.preventDefault();const t=a(),c=document.querySelector(".offcanvas-body"),s=document.getElementById("addGroup").classList.contains("visible"),o=e.target.id;if("addGroup"!==o||c.querySelector("input")||c.append(m("","",!0)),"save"===o&&s){const e=document.querySelector(".inputTitle"),a=e?.value;a&&(e.parentElement.remove(),c.append(m(a)),t.push({group:a,contacts:[]}),n(t),u())}"save"!==o||s||(()=>{const e=document.getElementById("fio"),t=document.getElementById("phone"),c=document.querySelector("select"),s=c.id.split("-");if(e?.value.trim().length>0&&18===t?.value.trim().length&&c?.value.trim().length>0){const o=a(),r={name:e.value,phone:t.value},l=o.filter((e=>e.group===c.value)),d=o.indexOf(l[0]),i=o[d];i.contacts.push(r),o.splice(d,1,i),n(o),+s[0]>=0&&+s[1]>=0&&p(+s[0],+s[1]),e.value="",t.value="",c.value=""}u()})()})(e)))})();